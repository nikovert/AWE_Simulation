(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    454995,      10618]
NotebookOptionsPosition[    449840,      10544]
NotebookOutlinePosition[    450232,      10560]
CellTagsIndexPosition[    450189,      10557]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["Minimization of the Hamiltonian", "Title"]], "Text",
 CellChangeTimes->{{3.838316472395691*^9, 
  3.83831648065539*^9}},ExpressionUUID->"e0592258-164f-4233-8d2c-\
bb4f2c79f025"],

Cell[TextData[StyleBox["TransformationMatrices", "Subsection"]], "Text",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{3.838316459989171*^9, 
  3.8459175766828613`*^9},ExpressionUUID->"35351875-222b-4d16-89f0-\
9d73a4269879"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"k", "\[Element]", "Reals"}], "&&", 
    RowBox[{"c", "\[Element]", "Reals"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"vshearX", "\[Element]", "Reals"}], "&&", 
    RowBox[{"vshearY", "\[Element]", "Reals"}], " ", "&&", " ", 
    RowBox[{"vshearZ", "\[Element]", "Reals"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.84714994350357*^9, 3.847149943699212*^9}},
 CellLabel->
  "In[239]:=",ExpressionUUID->"208c51dc-1185-49f9-b8ba-5a5f84aac10e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"lGamma", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"ma", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"Deltat", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"h", "\[Element]", "Reals"}], "&&", 
    RowBox[{"lat", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"long", "\[Element]", "Reals"}], "&&", 
    RowBox[{"xi", "\[Element]", "Reals"}], "&&", 
    RowBox[{"va", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"chi", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"gamma", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"d1", "\[Element]", "Reals"}], "&&", " ", 
    RowBox[{"d2", "\[Element]", "Reals"}], "&&", 
    RowBox[{"d3", " ", "\[Element]", "Reals"}]}]}], ";"}]], "Input",
 CellLabel->
  "In[241]:=",ExpressionUUID->"0514c19f-cd19-410f-863c-68b8b8be4f2e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"t1", "\[Element]", "Reals"}], "&&", 
    RowBox[{"t2", "\[Element]", "Reals"}], " ", "&&", " ", 
    RowBox[{"t3", "\[Element]", "Reals"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{
    RowBox[{"tpar1", "\[Element]", "Reals"}], "&&", 
    RowBox[{"tpar2", "\[Element]", "Reals"}], " ", "&&", " ", 
    RowBox[{"tpar3", "\[Element]", "Reals"}]}]}], ";"}]}], "Input",
 CellLabel->
  "In[242]:=",ExpressionUUID->"b695458a-7fc3-4846-b01d-3e544e1bd271"],

Cell[BoxData[{
 RowBox[{"MtauW", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "lat", "]"}]}], "*", 
       RowBox[{"Cos", "[", "long", "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "lat", "]"}]}], "*", 
       RowBox[{"Sin", "[", "long", "]"}]}], ",", 
      RowBox[{"Cos", "[", "lat", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "long", "]"}]}], ",", 
      RowBox[{"Cos", "[", "long", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "lat", "]"}]}], "*", 
       RowBox[{"Cos", "[", "long", "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "lat", "]"}]}], "*", 
       RowBox[{"Sin", "[", "long", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "lat", "]"}]}]}], "}"}]}], "}"}]}], "\n", 
 RowBox[{"MOW", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "xi", "]"}], ",", 
      RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "xi", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "\n", 
 RowBox[{"MWO", "=", 
  RowBox[{
   RowBox[{"MOW", "[", "xi", "]"}], "\[Transpose]"}]}], "\n", 
 RowBox[{"MAbarO", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "chi", "]"}], "*", 
       RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "chi", "]"}], "*", 
       RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
      RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "chi", "]"}], "*", 
       RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "chi", "]"}], "*", 
       RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
      RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}]}], "\n", 
 RowBox[{"MOAbar", "=", 
  RowBox[{
   RowBox[{"MAbarO", "[", 
    RowBox[{"chi", ",", " ", "gamma"}], "]"}], "\[Transpose]"}]}], "\n", 
 RowBox[{"MAbarA", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Cos", "[", "mu", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "mu", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Sin", "[", "mu", "]"}], ",", 
      RowBox[{"Cos", "[", "mu", "]"}]}], "}"}]}], "}"}]}], "\n", 
 RowBox[{"MAB", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "alpha", "]"}], "*", 
       RowBox[{"Cos", "[", "beta", "]"}]}], ",", 
      RowBox[{"Sin", "[", "beta", "]"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "alpha", "]"}], "*", 
       RowBox[{"Cos", "[", "beta", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Cos", "[", "alpha", "]"}]}], "*", 
       RowBox[{"Sin", "[", "beta", "]"}]}], ",", 
      RowBox[{"Cos", "[", "beta", "]"}], ",", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "alpha", "]"}]}], "*", 
       RowBox[{"Sin", "[", "beta", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "alpha", "]"}]}], ",", "0", ",", 
      RowBox[{"Cos", "[", "alpha", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]"}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.8382365907971287`*^9, 3.838236608650258*^9}, {
   3.8382372741656923`*^9, 3.838237274172669*^9}, {3.838238030499702*^9, 
   3.8382380394920692`*^9}, {3.838238142830854*^9, 3.838238146930093*^9}, {
   3.838239295088925*^9, 3.838239325902267*^9}, {3.838239369988619*^9, 
   3.838239377464875*^9}, {3.838239577462019*^9, 3.838239587644635*^9}, 
   3.838239735245657*^9, 3.8459175530652514`*^9, {3.846017610300714*^9, 
   3.8460176173197927`*^9}, {3.847147186258484*^9, 3.847147218768023*^9}, {
   3.847147918425535*^9, 3.8471479726839647`*^9}, {3.847149859519829*^9, 
   3.8471498753333673`*^9}},
 CellLabel->
  "In[244]:=",ExpressionUUID->"bbaf0df0-ee85-4940-9dc7-7fe91776b3e8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "long", "]"}]}], " ", 
      RowBox[{"Sin", "[", "lat", "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "lat", "]"}]}], " ", 
      RowBox[{"Sin", "[", "long", "]"}]}], ",", 
     RowBox[{"Cos", "[", "lat", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "long", "]"}]}], ",", 
     RowBox[{"Cos", "[", "long", "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "lat", "]"}]}], " ", 
      RowBox[{"Cos", "[", "long", "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "lat", "]"}]}], " ", 
      RowBox[{"Sin", "[", "long", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "lat", "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150036552671*^9},
 CellLabel->
  "Out[244]=",ExpressionUUID->"05b2ded2-caa3-45ae-990b-8f6517cf85a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "xi", "]"}], ",", 
     RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", "xi", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150036555113*^9},
 CellLabel->
  "Out[245]=",ExpressionUUID->"c1a3c72d-dc75-4d50-aebc-0df30c2e6bb4"],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "xi", "]"}], ",", 
       RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "xi", "]"}], ",", 
       RowBox[{"-", 
        RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.847150036557487*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"9c4bbb26-9d2f-41fd-8481-2fc337e535a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "chi", "]"}], " ", 
      RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "gamma", "]"}], " ", 
      RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
     RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "chi", "]"}], " ", 
      RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "chi", "]"}], " ", 
      RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
     RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150036560915*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"3aa925f2-b223-424f-97f2-0e12fb6dd567"],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "chi", "]"}], " ", 
        RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Cos", "[", "gamma", "]"}], " ", 
        RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
       RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "chi", "]"}], " ", 
        RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "chi", "]"}], " ", 
        RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
       RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.847150036564774*^9},
 CellLabel->
  "Out[248]=",ExpressionUUID->"88fd83d8-91a0-4a64-bad9-b34ffb4b239f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"Cos", "[", "mu", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "mu", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"Sin", "[", "mu", "]"}], ",", 
     RowBox[{"Cos", "[", "mu", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8471500365677633`*^9},
 CellLabel->
  "Out[249]=",ExpressionUUID->"6b9403de-a68b-488f-ad39-dfd11f82325b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "alpha", "]"}], " ", 
      RowBox[{"Cos", "[", "beta", "]"}]}], ",", 
     RowBox[{"Sin", "[", "beta", "]"}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "beta", "]"}], " ", 
      RowBox[{"Sin", "[", "alpha", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "alpha", "]"}]}], " ", 
      RowBox[{"Sin", "[", "beta", "]"}]}], ",", 
     RowBox[{"Cos", "[", "beta", "]"}], ",", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "alpha", "]"}]}], " ", 
      RowBox[{"Sin", "[", "beta", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "alpha", "]"}]}], ",", "0", ",", 
     RowBox[{"Cos", "[", "alpha", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150036572047*^9},
 CellLabel->
  "Out[250]=",ExpressionUUID->"288642df-0784-43e9-80f7-ad2bec45f3c4"],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 0.5}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{
  Inherited, 3},ExpressionUUID->"33155a2b-2511-488a-a503-60913a9f9575"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vkW", "=", " ", 
    RowBox[{
     RowBox[{"MWO", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MOAbar", " ", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "va", "}"}], ",", " ", 
           RowBox[{"{", "0", "}"}], ",", " ", 
           RowBox[{"{", "0", "}"}]}], "}"}]}], " ", "+", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "vshearX", "}"}], ",", " ", 
          RowBox[{"{", "vshearY", "}"}], ",", " ", 
          RowBox[{"{", "vshearZ", "}"}]}], "}"}]}], " ", ")"}]}], "+", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "d1", "}"}], ",", " ", 
       RowBox[{"{", "d2", "}"}], ",", " ", 
       RowBox[{"{", "d3", "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"vktau", "=", " ", 
    RowBox[{"MtauW", " ", ".", " ", "vkW"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"DlongDt", "[", 
      RowBox[{
      "h_", ",", "lat_", ",", " ", "long_", ",", "xi_", ",", "va_", ",", " ", 
       "chi_", ",", " ", "gamma_", ",", " ", "d1_", ",", " ", "d2_", ",", 
       "d3_"}], "]"}], " ", ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{"1", "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cos", "[", "lat", "]"}], "*", "h"}], ")"}]}], ",", " ",
            "0"}], "}"}], "}"}], " ", ".", " ", 
        RowBox[{"vktau", "[", 
         RowBox[{
         "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", ",", 
          " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}]}], 
       "\[IndentingNewLine]", 
       RowBox[{"DlatDt", "[", 
        RowBox[{
        "h_", ",", "lat_", ",", " ", "long_", ",", "xi_", ",", "va_", ",", 
         " ", "chi_", ",", " ", "gamma_", ",", " ", "d1_", ",", " ", "d2_", 
         ",", "d3_"}], "]"}]}], " ", ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "/", "h"}], ",", " ", "0", ",", " ", "0"}], "}"}], 
          " ", "}"}], ".", " ", 
         RowBox[{"vktau", "[", 
          RowBox[{
          "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", ",",
            " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], 
          "]"}]}], "\[IndentingNewLine]", 
        RowBox[{"DhDt", "[", 
         RowBox[{
         "h_", ",", "lat_", ",", " ", "long_", ",", "xi_", ",", "va_", ",", 
          " ", "chi_", ",", " ", "gamma_", ",", " ", "d1_", ",", " ", "d2_", 
          ",", "d3_"}], "]"}]}], " ", ":=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}], "}"}], ".", 
        RowBox[{"vktau", "[", 
         RowBox[{
         "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", ",", 
          " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], 
         "]"}]}]}]}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.8471348345919943`*^9, 3.847135169217224*^9}, {
   3.847135209843895*^9, 3.847135244130743*^9}, {3.847135495721814*^9, 
   3.847135508432528*^9}, {3.847135714939022*^9, 3.847135730601843*^9}, {
   3.84713580310814*^9, 3.847135806076251*^9}, {3.847136001202313*^9, 
   3.84713604115386*^9}, {3.8471360759958887`*^9, 3.847136214885779*^9}, {
   3.847136421714492*^9, 3.847136485696946*^9}, {3.8471365184781017`*^9, 
   3.8471365263876123`*^9}, {3.847136593574554*^9, 3.847136601671146*^9}, {
   3.847136641720199*^9, 3.847136713626562*^9}, {3.8471367545811167`*^9, 
   3.847136834956863*^9}, {3.847136894565914*^9, 3.847136905064768*^9}, {
   3.847137070950178*^9, 3.847137080402516*^9}, {3.847137129907008*^9, 
   3.847137166663052*^9}, {3.8471371990895348`*^9, 3.847137274503937*^9}, {
   3.847137307308395*^9, 3.847137323582163*^9}, {3.847139256056744*^9, 
   3.847139362891972*^9}, {3.8471401106399384`*^9, 3.8471401341590233`*^9}, {
   3.8471404923487377`*^9, 3.847140563201754*^9}, {3.8471406856726093`*^9, 
   3.847140728236329*^9}, {3.847140957244174*^9, 3.847140977252722*^9}, {
   3.847141065118137*^9, 3.8471411271868563`*^9}, {3.8471411735265007`*^9, 
   3.847141250976654*^9}, {3.8471413200317383`*^9, 3.8471414377173223`*^9}, {
   3.847141513622508*^9, 3.847141560685869*^9}, 3.847141762693322*^9, {
   3.8471418879909782`*^9, 3.8471419158217916`*^9}, {3.847142076005209*^9, 
   3.8471420796131887`*^9}, {3.847142347783691*^9, 3.84714239685439*^9}, {
   3.847142445595931*^9, 3.847142478883978*^9}, {3.847142603441184*^9, 
   3.8471426051152*^9}, 3.847142650989751*^9, {3.847142684877396*^9, 
   3.847142692274275*^9}, {3.847143043963015*^9, 3.8471432007256823`*^9}, {
   3.847143466771956*^9, 3.847143503208528*^9}, {3.847143533987647*^9, 
   3.84714353506383*^9}, {3.847143569933751*^9, 3.847143590001214*^9}, {
   3.847143719611719*^9, 3.847143721771428*^9}, {3.847143845088544*^9, 
   3.847143848773694*^9}, {3.847143935423532*^9, 3.847143939607107*^9}, {
   3.847145110605323*^9, 3.847145129053554*^9}, 3.847145618891486*^9, 
   3.847145727035487*^9, {3.847147186274008*^9, 3.8471472007370996`*^9}, {
   3.8471479905930862`*^9, 3.847148023276703*^9}, {3.847148057758424*^9, 
   3.8471481610858603`*^9}, 3.847149767939238*^9, {3.847149881803115*^9, 
   3.847149886956668*^9}, {3.847149941920765*^9, 3.847149980797494*^9}},
 CellLabel->
  "In[251]:=",ExpressionUUID->"bc65398b-1e95-4d88-b4e4-ad2a8becb87a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"d1", "+", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "xi", "]"}], ",", 
            RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "xi", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
      ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vshearX", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vshearY", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vshearZ", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"d2", "+", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "xi", "]"}], ",", 
            RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "xi", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
      ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vshearX", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vshearY", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vshearZ", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"d3", "+", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Cos", "[", "xi", "]"}], ",", 
            RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sin", "[", "xi", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
      ".", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"vshearX", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vshearY", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"vshearZ", "+", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Cos", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Sin", "[", "chi", "]"}], " ", 
                  RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                 RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
             RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "va", "}"}], ",", 
             RowBox[{"{", "0", "}"}], ",", 
             RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150041563303*^9},
 CellLabel->
  "Out[251]=",ExpressionUUID->"ac673259-b1c1-41d2-bbd8-09785745f7b2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d3", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "long", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d1", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", "lat", "]"}], " ", 
      RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "long", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d2", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d1", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Cos", "[", "lat", "]"}]}], " ", 
      RowBox[{"Cos", "[", "long", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d1", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d3", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d2", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150041574965*^9},
 CellLabel->
  "Out[252]=",ExpressionUUID->"f479887b-3cdb-43d8-a3da-e854693674ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DlongDt", "=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], "*", "h"}], ")"}]}], " ", 
   RowBox[{"vktau", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"DlatDt", "=", 
  RowBox[{
   RowBox[{"1", "/", "h"}], " ", 
   RowBox[{"vktau", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"DhDt", "=", 
  RowBox[{
   RowBox[{"-", "1"}], 
   RowBox[{"vktau", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.847149773074195*^9, 3.847149811015717*^9}, {
  3.847149891838602*^9, 3.847149898508926*^9}, {3.847149988399685*^9, 
  3.847149993820997*^9}},
 CellLabel->
  "In[253]:=",ExpressionUUID->"5a27028c-e3b0-467f-8ec6-5c191eca6d36"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "h"], 
   RowBox[{
    RowBox[{"Sec", "[", "lat", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "long", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"d2", "+", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", "xi", "]"}], ",", 
                RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sin", "[", "xi", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}],
           ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vshearX", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                 RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "va", "}"}], ",", 
                 RowBox[{"{", "0", "}"}], ",", 
                 RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"vshearY", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                 RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "va", "}"}], ",", 
                 RowBox[{"{", "0", "}"}], ",", 
                 RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"vshearZ", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                 RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "va", "}"}], ",", 
                 RowBox[{"{", "0", "}"}], ",", 
                 RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
        ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d1", "+", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Cos", "[", "xi", "]"}], ",", 
                RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sin", "[", "xi", "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}],
           ".", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"vshearX", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                 RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "va", "}"}], ",", 
                 RowBox[{"{", "0", "}"}], ",", 
                 RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"vshearY", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                 RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "va", "}"}], ",", 
                 RowBox[{"{", "0", "}"}], ",", 
                 RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"vshearZ", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                   
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                 RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "va", "}"}], ",", 
                 RowBox[{"{", "0", "}"}], ",", 
                 RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
        ")"}], " ", 
       RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150054305153*^9},
 CellLabel->
  "Out[253]=",ExpressionUUID->"8dcf8c60-1d48-473c-a72f-b504067403ee"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "h"], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d3", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"Cos", "[", "long", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d1", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d2", "+", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Cos", "[", "xi", "]"}], ",", 
               RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Sin", "[", "xi", "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", 
               RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
         ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"vshearX", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearY", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"vshearZ", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                  
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", "va", "}"}], ",", 
                RowBox[{"{", "0", "}"}], ",", 
                RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
       ")"}], " ", 
      RowBox[{"Sin", "[", "lat", "]"}], " ", 
      RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150054317089*^9},
 CellLabel->
  "Out[254]=",ExpressionUUID->"a518a8eb-cfde-45c7-a747-171773242656"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "lat", "]"}], " ", 
    RowBox[{"Cos", "[", "long", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"d1", "+", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "xi", "]"}], ",", 
             RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", "xi", "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
       ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vshearX", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"vshearY", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"vshearZ", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
     ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"d3", "+", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "xi", "]"}], ",", 
             RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", "xi", "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
       ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vshearX", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"vshearY", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"vshearZ", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], ")"}],
     " ", 
    RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", "lat", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{"d2", "+", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "xi", "]"}], ",", 
             RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Sin", "[", "xi", "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], "]"}], 
       ".", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"vshearX", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"vshearY", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"vshearZ", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cos", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{
                   RowBox[{"Sin", "[", "chi", "]"}], " ", 
                   RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                  RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
              RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", "va", "}"}], ",", 
              RowBox[{"{", "0", "}"}], ",", 
              RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], ")"}],
     " ", 
    RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150054326888*^9},
 CellLabel->
  "Out[255]=",ExpressionUUID->"5fbc2163-c1c0-4dd4-a333-334f3437808c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"n", " ", "=", " ", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"paircraft", "=", " ", 
  RowBox[{"h", " ", "*", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
       RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
       RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"pi", "=", " ", 
  RowBox[{"i", "*", 
   RowBox[{"h", "/", 
    RowBox[{"(", 
     RowBox[{"n", "+", "1"}], ")"}]}], " ", "*", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
       RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
       RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], 
    "}"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8471348345919943`*^9, 3.847135169217224*^9}, {
   3.847135209843895*^9, 3.847135244130743*^9}, {3.847135495721814*^9, 
   3.847135508432528*^9}, {3.847135714939022*^9, 3.847135730601843*^9}, {
   3.84713580310814*^9, 3.847135806076251*^9}, {3.847136001202313*^9, 
   3.84713604115386*^9}, {3.8471360759958887`*^9, 3.847136214885779*^9}, {
   3.847136421714492*^9, 3.847136485696946*^9}, {3.8471365184781017`*^9, 
   3.8471365263876123`*^9}, {3.847136593574554*^9, 3.847136601671146*^9}, {
   3.847136641720199*^9, 3.847136713626562*^9}, {3.8471367545811167`*^9, 
   3.847136834956863*^9}, {3.847136894565914*^9, 3.847136905064768*^9}, {
   3.847137070950178*^9, 3.847137080402516*^9}, {3.847137129907008*^9, 
   3.847137166663052*^9}, {3.8471371990895348`*^9, 3.847137274503937*^9}, {
   3.847137307308395*^9, 3.847137323582163*^9}, {3.847139256056744*^9, 
   3.847139362891972*^9}, {3.8471401106399384`*^9, 3.8471401341590233`*^9}, {
   3.8471404923487377`*^9, 3.847140563201754*^9}, {3.8471406856726093`*^9, 
   3.847140728236329*^9}, {3.847140957244174*^9, 3.847140977252722*^9}, {
   3.847141065118137*^9, 3.8471411271868563`*^9}, {3.8471411735265007`*^9, 
   3.847141250976654*^9}, {3.8471413200317383`*^9, 3.8471414377173223`*^9}, {
   3.847141513622508*^9, 3.847141560685869*^9}, 3.847141762693322*^9, {
   3.8471418879909782`*^9, 3.8471419158217916`*^9}, {3.847142076005209*^9, 
   3.8471420796131887`*^9}, {3.847142347783691*^9, 3.84714239685439*^9}, {
   3.847142445595931*^9, 3.847142478883978*^9}, {3.847142603441184*^9, 
   3.8471426051152*^9}, 3.847142650989751*^9, {3.847142684877396*^9, 
   3.847142692274275*^9}, {3.847143043963015*^9, 3.8471432007256823`*^9}, {
   3.847143466771956*^9, 3.847143503208528*^9}, {3.847143533987647*^9, 
   3.84714353506383*^9}, {3.847143569933751*^9, 3.847143590001214*^9}, 
   3.847143977967654*^9, 3.847145723774955*^9, {3.847147186293027*^9, 
   3.847147200775547*^9}, {3.847148196673764*^9, 3.847148229314395*^9}, 
   3.847148329473078*^9, 3.8471485456103287`*^9, {3.8471499023104143`*^9, 
   3.847149915021058*^9}, {3.847150004969755*^9, 3.847150021210004*^9}, {
   3.847150070073429*^9, 3.847150083674116*^9}, {3.847150119554408*^9, 
   3.847150238421825*^9}},
 CellLabel->
  "In[285]:=",ExpressionUUID->"2d7677be-703e-468b-a27d-192c34e7f33e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", " ", 
     RowBox[{"Sin", "[", "lat", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150204757683*^9, 3.8471502397241163`*^9},
 CellLabel->
  "Out[286]=",ExpressionUUID->"a364ca56-278b-4484-befc-a7e3f25391fc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "6"], " ", "h", " ", "i", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "6"], " ", "h", " ", "i", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "6"], " ", "h", " ", "i", " ", 
     RowBox[{"Sin", "[", "lat", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847150204757683*^9, 3.8471502397263403`*^9},
 CellLabel->
  "Out[287]=",ExpressionUUID->"1c3b0ab8-c000-4db1-b68c-247d6fd22dd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vaircraft", "=", " ", 
    RowBox[{
     RowBox[{"DhDt", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}], " ", "-", " ", 
     RowBox[{"h", " ", "*", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "lat", "]"}], " ", ".", "DlatDt"}], "*", " ", 
           
           RowBox[{"Cos", "[", "long", "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
           RowBox[{
            RowBox[{"Sin", "[", "long", "]"}], ".", "DlongDt"}]}]}], "}"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "lat", "]"}], " ", ".", "DlatDt"}], "*", " ", 
           
           RowBox[{"Sin", "[", "long", "]"}]}], " ", "-", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
           RowBox[{
            RowBox[{"Cos", "[", "long", "]"}], ".", "DlongDt"}]}]}], "}"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Cos", "[", "lat", "]"}], " ", ".", " ", "DlatDt"}]}], 
         "}"}]}], "}"}]}]}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"vi", "=", " ", 
    RowBox[{
     RowBox[{"DhDt", " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}], " ", "-", " ", 
     RowBox[{"i", "*", 
      RowBox[{"h", "/", 
       RowBox[{"(", 
        RowBox[{"n", "+", "1"}], ")"}]}], " ", "*", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "lat", "]"}], " ", ".", "DlatDt"}], "*", " ", 
           
           RowBox[{"Cos", "[", "long", "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
           RowBox[{
            RowBox[{"Sin", "[", "long", "]"}], ".", "DlongDt"}]}]}], "}"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sin", "[", "lat", "]"}], " ", ".", "DlatDt"}], "*", " ", 
           
           RowBox[{"Sin", "[", "long", "]"}]}], " ", "-", " ", 
          RowBox[{
           RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
           RowBox[{
            RowBox[{"Cos", "[", "long", "]"}], ".", "DlongDt"}]}]}], "}"}], 
        ",", " ", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Cos", "[", "lat", "]"}], " ", ".", " ", "DlatDt"}]}], 
         "}"}]}], "}"}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.8471348345919943`*^9, 3.847135169217224*^9}, {
   3.847135209843895*^9, 3.847135244130743*^9}, {3.847135495721814*^9, 
   3.847135508432528*^9}, {3.847135714939022*^9, 3.847135730601843*^9}, {
   3.84713580310814*^9, 3.847135806076251*^9}, {3.847136001202313*^9, 
   3.84713604115386*^9}, {3.8471360759958887`*^9, 3.847136214885779*^9}, {
   3.847136421714492*^9, 3.847136485696946*^9}, {3.8471365184781017`*^9, 
   3.8471365263876123`*^9}, {3.847136593574554*^9, 3.847136601671146*^9}, {
   3.847136641720199*^9, 3.847136713626562*^9}, {3.8471367545811167`*^9, 
   3.847136834956863*^9}, {3.847136894565914*^9, 3.847136905064768*^9}, {
   3.847137070950178*^9, 3.847137080402516*^9}, {3.847137129907008*^9, 
   3.847137166663052*^9}, {3.8471371990895348`*^9, 3.847137274503937*^9}, {
   3.847137307308395*^9, 3.847137323582163*^9}, {3.847139256056744*^9, 
   3.847139362891972*^9}, {3.8471401106399384`*^9, 3.8471401341590233`*^9}, {
   3.8471404923487377`*^9, 3.847140563201754*^9}, {3.8471406856726093`*^9, 
   3.847140728236329*^9}, {3.847140957244174*^9, 3.847140977252722*^9}, {
   3.847141065118137*^9, 3.8471411271868563`*^9}, {3.8471411735265007`*^9, 
   3.847141250976654*^9}, {3.8471413200317383`*^9, 3.8471414377173223`*^9}, {
   3.847141513622508*^9, 3.847141560685869*^9}, 3.847141762693322*^9, {
   3.8471418879909782`*^9, 3.8471419158217916`*^9}, {3.847142076005209*^9, 
   3.8471420796131887`*^9}, {3.847142347783691*^9, 3.84714239685439*^9}, {
   3.847142445595931*^9, 3.847142478883978*^9}, {3.847142603441184*^9, 
   3.8471426051152*^9}, 3.847142650989751*^9, {3.847142684877396*^9, 
   3.847142692274275*^9}, {3.847143043963015*^9, 3.8471432007256823`*^9}, {
   3.847143466771956*^9, 3.847143503208528*^9}, {3.847143533987647*^9, 
   3.84714353506383*^9}, {3.847143569933751*^9, 3.847143590001214*^9}, 
   3.847143977967654*^9, 3.847145723774955*^9, {3.847147186293027*^9, 
   3.847147200775547*^9}, {3.847148196673764*^9, 3.847148229314395*^9}, 
   3.847148329473078*^9, 3.8471485456103287`*^9, {3.8471499023104143`*^9, 
   3.847149915021058*^9}, {3.847150004969755*^9, 3.847150021210004*^9}, {
   3.847150070073429*^9, 3.847150083674116*^9}, {3.847150119554408*^9, 
   3.847150200165969*^9}},ExpressionUUID->"ac40dc70-341d-4bae-be2c-\
825a3e27a009"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"h", " ", 
     RowBox[{"Sin", "[", "lat", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.847150091334813*^9, {3.8471501231587954`*^9, 3.847150158171763*^9}},
 CellLabel->
  "Out[272]=",ExpressionUUID->"00839ee9-670c-4956-9fc1-61aa0cadd854"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "6"], " ", "h", " ", "i", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "6"], " ", "h", " ", "i", " ", 
     RowBox[{"Cos", "[", "lat", "]"}], " ", 
     RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "6"], " ", "h", " ", "i", " ", 
     RowBox[{"Sin", "[", "lat", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.847150091334813*^9, {3.8471501231587954`*^9, 3.847150158173992*^9}},
 CellLabel->
  "Out[273]=",ExpressionUUID->"4b1b3054-effa-47a3-ab2f-81ba99e9ff4c"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \
\\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}], \\\" \\\
\", RowBox[{\\\"(\\\", RowBox[{\\\"d1\\\", \\\"+\\\", \
RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}]}], \\\")\\\"}]}], \
\\\"+\\\", RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"d3\\\", \\\"+\\\", \
RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}]}], \\\")\\\"}], \\\" \
\\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"d2\\\", \\\"+\\\", \
RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}]}], \\\")\\\"}], \\\" \
\\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}]}]}], \
\\\"}\\\"}], \\\" \\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\
\\\", \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"long\\\", \
\\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\"}\\\"}]}], \
\\\"}\\\"}]}]\\) cannot be combined.\"", 2, 274, 44, 34178645679563922736, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.847150091387101*^9, {3.84715012316363*^9, 3.8471501581776752`*^9}},
 CellLabel->
  "During evaluation of \
In[271]:=",ExpressionUUID->"9a72dcb8-cff0-4b27-a470-ecdfd13ce61d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "h"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{
          RowBox[{"Sin", "[", "lat", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "lat", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d3", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "long", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d1", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d2", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}], " ", 
               RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}], "}"}]}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{
          RowBox[{"Sin", "[", "long", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{
             RowBox[{"Sec", "[", "lat", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "long", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"d2", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}], " ", 
                RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}]}], "}"}]}]}]}],
        ")"}]}], "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d2", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d2", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}], "-", 
     RowBox[{"h", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "lat", "]"}]}], " ", 
         RowBox[{
          RowBox[{"Cos", "[", "long", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{
             RowBox[{"Sec", "[", "lat", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "long", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"d2", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}], " ", 
                RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}]}], "}"}]}]}], 
        "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "lat", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "lat", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d3", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "long", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d1", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d2", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}], " ", 
               RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}], "}"}]}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"h", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "lat", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "h"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "lat", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"d3", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"vshearX", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearY", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearZ", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
             ")"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "long", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"d1", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"vshearX", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearY", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearZ", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
             ")"}], " ", 
            RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d2", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"vshearX", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearY", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearZ", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
             ")"}], " ", 
            RowBox[{"Sin", "[", "lat", "]"}], " ", 
            RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}], "}"}]}]}], "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d2", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.847150091334813*^9, {3.8471501231587954`*^9, 3.847150158209826*^9}},
 CellLabel->
  "Out[274]=",ExpressionUUID->"4d87aa81-92ef-4361-82af-b6d42fefefd3"],

Cell[BoxData[
 RowBox[{"{", "1", "}"}]], "Output",
 CellChangeTimes->{
  3.847150091334813*^9, {3.8471501231587954`*^9, 3.8471501582745037`*^9}},
 CellLabel->
  "Out[275]=",ExpressionUUID->"fc7597cd-0b44-4b8f-a34a-1f43848f5e1f"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \
\\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}], \\\" \\\
\", RowBox[{\\\"(\\\", RowBox[{\\\"d1\\\", \\\"+\\\", \
RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}]}], \\\")\\\"}]}], \
\\\"+\\\", RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"d3\\\", \\\"+\\\", \
RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}]}], \\\")\\\"}], \\\" \
\\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"d2\\\", \\\"+\\\", \
RowBox[{RowBox[{\\\"Transpose\\\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}], \\\".\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\
\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}]}], \\\")\\\"}], \\\" \
\\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}]}]}], \
\\\"}\\\"}], \\\" \\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\
\\\", \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"long\\\", \
\\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\"}\\\"}]}], \
\\\"}\\\"}]}]\\) cannot be combined.\"", 2, 276, 45, 34178645679563922736, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.847150091387101*^9, {3.84715012316363*^9, 3.8471501582764397`*^9}},
 CellLabel->
  "During evaluation of \
In[271]:=",ExpressionUUID->"84def204-ebb9-40e2-a55f-a9195b5c7308"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "6"]}], " ", "h", " ", "i", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{
          RowBox[{"Sin", "[", "lat", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "lat", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d3", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "long", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d1", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d2", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}], " ", 
               RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}], "}"}]}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{
          RowBox[{"Sin", "[", "long", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{
             RowBox[{"Sec", "[", "lat", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "long", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"d2", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}], " ", 
                RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}]}], "}"}]}]}]}],
        ")"}]}], "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d2", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d2", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}], "-", 
     RowBox[{
      FractionBox["1", "6"], " ", "h", " ", "i", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "lat", "]"}]}], " ", 
         RowBox[{
          RowBox[{"Cos", "[", "long", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{
             RowBox[{"Sec", "[", "lat", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Cos", "[", "long", "]"}], " ", 
                RowBox[{"(", 
                 RowBox[{"d2", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"d1", "+", 
                  RowBox[{
                   RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                    "]"}], ".", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                 ")"}], " ", 
                RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}]}], "}"}]}]}], 
        "+", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "lat", "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
            FractionBox["1", "h"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Cos", "[", "lat", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d3", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}]}], "-", 
              RowBox[{
               RowBox[{"Cos", "[", "long", "]"}], " ", 
               RowBox[{"(", 
                RowBox[{"d1", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d2", "+", 
                 RowBox[{
                  RowBox[{"Transpose", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                   "]"}], ".", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"vshearX", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearY", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"vshearZ", "+", 
                    RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
                ")"}], " ", 
               RowBox[{"Sin", "[", "lat", "]"}], " ", 
               RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}], "}"}]}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "6"], " ", "h", " ", "i", " ", 
      RowBox[{
       RowBox[{"Cos", "[", "lat", "]"}], ".", 
       RowBox[{"{", 
        RowBox[{
         FractionBox["1", "h"], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "lat", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"d3", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"vshearX", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearY", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearZ", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
             ")"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "long", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"d1", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"vshearX", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearY", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearZ", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
             ")"}], " ", 
            RowBox[{"Sin", "[", "lat", "]"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d2", "+", 
              RowBox[{
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Cos", "[", "xi", "]"}], ",", 
                    RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Sin", "[", "xi", "]"}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"0", ",", "0", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
                "]"}], ".", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"vshearX", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearY", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"vshearZ", "+", 
                   RowBox[{
                    RowBox[{"Transpose", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                    RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", "va", "}"}], ",", 
                    RowBox[{"{", "0", "}"}], ",", 
                    RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
             ")"}], " ", 
            RowBox[{"Sin", "[", "lat", "]"}], " ", 
            RowBox[{"Sin", "[", "long", "]"}]}]}], ")"}]}], "}"}]}]}], "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"Cos", "[", "long", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d1", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d3", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "lat", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"d2", "+", 
           RowBox[{
            RowBox[{"Transpose", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "xi", "]"}], ",", 
                  RowBox[{"Sin", "[", "xi", "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Sin", "[", "xi", "]"}], ",", 
                  RowBox[{"-", 
                   RowBox[{"Cos", "[", "xi", "]"}]}], ",", "0"}], "}"}], ",", 
                
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", 
                  RowBox[{"-", "1"}]}], "}"}]}], "}"}], "[", "xi", "]"}], 
             "]"}], ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"vshearX", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearY", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"vshearZ", "+", 
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Cos", "[", "gamma", "]"}], " ", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"Sin", "[", "chi", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "chi", "]"}], ",", "0"}], "}"}], ",", 
                    
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cos", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{
                    RowBox[{"Sin", "[", "chi", "]"}], " ", 
                    RowBox[{"Sin", "[", "gamma", "]"}]}], ",", 
                    RowBox[{"Cos", "[", "gamma", "]"}]}], "}"}]}], "}"}], "[", 
                   RowBox[{"chi", ",", "gamma"}], "]"}], "]"}], ".", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", "va", "}"}], ",", 
                   RowBox[{"{", "0", "}"}], ",", 
                   RowBox[{"{", "0", "}"}]}], "}"}]}]}], "}"}]}], "}"}]}]}], 
          ")"}], " ", 
         RowBox[{"Sin", "[", "long", "]"}]}]}], "}"}], " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", "lat", "]"}], " ", 
          RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.847150091334813*^9, {3.8471501231587954`*^9, 3.84715015830366*^9}},
 CellLabel->
  "Out[276]=",ExpressionUUID->"2d8b3ff5-7017-403f-a63c-fc97e9b6694d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"DhDt", "[", 
   RowBox[{
   "h", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", 
    ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}], 
  " ", "*", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
      RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
      RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"DhDt", "[", 
   RowBox[{
   "h", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", 
    ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}], 
  " ", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
      RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
      RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}], " ", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixQ", "[", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
      RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", "*", " ", 
      RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.847148232835895*^9, 3.847148305464027*^9}, {
   3.847148335992222*^9, 3.8471484060369453`*^9}, 3.8471485534300013`*^9, {
   3.847148983144207*^9, 3.847148995643731*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"082d0dc1-0f56-46cd-a781-f45ba7679816"],

Cell[BoxData[
 TemplateBox[{
  "Thread", "tdlen", 
   "\"Objects of unequal length in \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{\\\"d3\\\", \
\\\"-\\\", \\\"vshearZ\\\", \\\"+\\\", RowBox[{\\\"va\\\", \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\")\\\"}], \\\" \\\", RowBox[{\
\\\"Sin\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"d2\\\", \\\"-\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\")\\\"}]}], \\\"+\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"d1\\\", \\\"+\\\", \
RowBox[{RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"+\\\", \
RowBox[{RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\")\\\"}]}]}], \\\"}\\\"}], \\\
\"}\\\"}], \\\" \\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"long\\\", \\\"]\\\"}]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"Cos\\\", \\\"[\\\", \\\"lat\
\\\", \\\"]\\\"}], \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"long\\\", \
\\\"]\\\"}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"Sin\\\", \\\"[\\\", \\\"lat\\\", \\\"]\\\"}], \\\"}\\\"}]}], \
\\\"}\\\"}]}]\\) cannot be combined.\"", 2, 228, 38, 34178645679563922736, 
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.8471489513857927`*^9, {3.847148983659294*^9, 3.8471489971607924`*^9}},
 CellLabel->
  "During evaluation of \
In[228]:=",ExpressionUUID->"40719363-1ace-42e3-925f-2c98ad7138b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"d3", "-", "vshearZ", "+", 
        RowBox[{"va", " ", 
         RowBox[{"Sin", "[", "gamma", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "lat", "]"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", 
      RowBox[{"Sin", "[", "long", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d2", "-", 
        RowBox[{
         RowBox[{"Cos", "[", "xi", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"vshearY", "+", 
           RowBox[{"va", " ", 
            RowBox[{"Cos", "[", "gamma", "]"}], " ", 
            RowBox[{"Sin", "[", "chi", "]"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vshearX", "+", 
           RowBox[{"va", " ", 
            RowBox[{"Cos", "[", "chi", "]"}], " ", 
            RowBox[{"Cos", "[", "gamma", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "xi", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", 
      RowBox[{"Cos", "[", "long", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"d1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vshearX", "+", 
           RowBox[{"va", " ", 
            RowBox[{"Cos", "[", "chi", "]"}], " ", 
            RowBox[{"Cos", "[", "gamma", "]"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", "xi", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"vshearY", "+", 
           RowBox[{"va", " ", 
            RowBox[{"Cos", "[", "gamma", "]"}], " ", 
            RowBox[{"Sin", "[", "chi", "]"}]}]}], ")"}], " ", 
         RowBox[{"Sin", "[", "xi", "]"}]}]}], ")"}]}]}], "}"}], "}"}], " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", 
      RowBox[{"Cos", "[", "long", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "lat", "]"}], " ", 
      RowBox[{"Sin", "[", "long", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Sin", "[", "lat", "]"}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{
  3.847148951407138*^9, {3.8471489836688843`*^9, 3.847148997169828*^9}},
 CellLabel->
  "Out[228]=",ExpressionUUID->"87addd6b-048f-43e3-888a-e352ac312195"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.847148951407138*^9, {3.8471489836688843`*^9, 3.847148997173321*^9}},
 CellLabel->
  "Out[229]=",ExpressionUUID->"03cff654-ce77-407b-b21e-6f1a241a4996"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.847148951407138*^9, {3.8471489836688843`*^9, 3.847148997176116*^9}},
 CellLabel->
  "Out[230]=",ExpressionUUID->"c13c3887-3a84-4c12-84a8-355f896600ae"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.847148951407138*^9, {3.8471489836688843`*^9, 3.847148997179142*^9}},
 CellLabel->
  "Out[231]=",ExpressionUUID->"2c3c9154-6a07-4451-9e38-9b2d41a93198"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"s", "[", 
   RowBox[{"h_", ",", "long_", ",", "lat_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"paircraft", "[", 
    RowBox[{"h", ",", "long", ",", "lat"}], "]"}], " ", "-", " ", 
   RowBox[{"pi", "[", 
    RowBox[{"n", ",", "h", ",", "long", ",", "lat"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.847139949268777*^9, 3.8471399838700323`*^9}, {
  3.847140152072311*^9, 3.8471401557734203`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"9c00d0bc-c7b2-47a8-a971-a6e00f0d3c12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sv", "[", 
   RowBox[{
   "h_", ",", "lat_", ",", " ", "long_", ",", "xi_", ",", "va_", ",", " ", 
    "chi_", ",", " ", "gamma_", ",", " ", "d1_", ",", " ", "d2_", ",", 
    "d3_"}], "]"}], " ", ":=", 
  RowBox[{
   RowBox[{"vaircraft", "[", 
    RowBox[{
    "h", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", 
     ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}], 
   " ", "-", 
   RowBox[{"vi", "[", 
    RowBox[{
    "n", ",", " ", "h", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", 
     ",", " ", "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", 
     "d3"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.847135535340493*^9, 3.847135591657892*^9}, {
  3.847139405751564*^9, 3.8471394205986443`*^9}, {3.847140146057585*^9, 
  3.8471401466658993`*^9}, {3.847147186326571*^9, 3.8471472007792263`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"e27a2517-93f6-44e0-ac0f-4cac1e4a7716"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8471462449261837`*^9, 3.847146253416946*^9}, 
   3.847146738789063*^9, 
   3.8471499340519037`*^9},ExpressionUUID->"4de9a154-a39a-4a0d-b558-\
137a62b9e279"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ft", "[", 
   RowBox[{
   "Deltat_", ",", " ", "h_", ",", "lat_", ",", " ", "long_", ",", "xi_", ",",
     "va_", ",", " ", "chi_", ",", " ", "gamma_", ",", " ", "d1_", ",", " ", 
    "d2_", ",", "d3_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"k", "*", "Deltat"}], "  ", "+", " ", 
     RowBox[{"c", "*", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{"h", ",", "long", ",", "lat"}], "]"}], "/", 
       RowBox[{"Norm", "[", 
        RowBox[{"s", "[", 
         RowBox[{"h", ",", "long", ",", "lat"}], "]"}], "]"}]}], "*", 
      RowBox[{"sv", "[", 
       RowBox[{
       "h", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", 
        "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}],
        "]"}]}]}], " ", ")"}], " ", "*", " ", 
   RowBox[{
    RowBox[{"s", "[", 
     RowBox[{"h", ",", "long", ",", "lat"}], "]"}], "/", 
    RowBox[{"Norm", "[", 
     RowBox[{"s", "[", 
      RowBox[{"h", ",", "long", ",", "lat"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.84713592942216*^9, 3.84713594467629*^9}, {
  3.847139995176877*^9, 3.8471400027338467`*^9}, {3.847140195683855*^9, 
  3.8471402554311857`*^9}, {3.84714033075098*^9, 3.8471403372773*^9}, {
  3.847147186331347*^9, 3.84714720078195*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"8c8f9ede-0b32-4638-94ee-00b2013f3ec0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"t", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"t1", ",", " ", "t2", ",", " ", "t3"}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tpar", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"tpar1", ",", " ", "tpar2", ",", " ", "tpar3"}], "}"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sdot", "[", 
     RowBox[{
     "lGamma_", ",", " ", "lat_", ",", " ", "long_", ",", "xi_", ",", "va_", 
      ",", " ", "chi_", ",", " ", "gamma_", ",", " ", "d1_", ",", " ", "d2_", 
      ",", "d3_"}], "]"}], " ", ":=", 
    RowBox[{
     RowBox[{"t", ".", 
      RowBox[{"vktau", "[", 
       RowBox[{
       "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", ",", 
        " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}]}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Norm", "[", "t", "]"}], "*", "lGamma"}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sigmadot", "[", 
     RowBox[{
     "lat_", ",", " ", "long_", ",", "xi_", ",", "va_", ",", " ", "chi_", ",",
       " ", "gamma_", ",", " ", "d1_", ",", " ", "d2_", ",", "d3_"}], "]"}], 
    " ", ":=", 
    RowBox[{
     RowBox[{"tpar", ".", 
      RowBox[{"vktau", "[", 
       RowBox[{
       "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", ",", 
        " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}]}], 
     "/", 
     RowBox[{"(", 
      RowBox[{"Norm", "[", "tpar", "]"}], ")"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.847144490916091*^9, 3.847144638526869*^9}, {
   3.847144683047241*^9, 3.847144688197576*^9}, {3.8471449695168867`*^9, 
   3.847144980985243*^9}, {3.847145044060122*^9, 3.847145083488678*^9}, {
   3.8471451688883963`*^9, 3.847145199472699*^9}, {3.847145613466457*^9, 
   3.847145614052567*^9}, {3.8471457006043587`*^9, 3.847145704433805*^9}, 
   3.847145818303849*^9, {3.8471471863347073`*^9, 3.8471472007873507`*^9}, {
   3.847149711862658*^9, 3.8471497430179033`*^9}, {3.847149949060615*^9, 
   3.8471499631395063`*^9}},ExpressionUUID->"97e17675-e833-4ecd-92e0-\
19313e44b661"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{3.8471497169414053`*^9},
 CellLabel->
  "Out[235]=",ExpressionUUID->"b40d0d98-89a0-42d1-8c3f-76bff4fae2ea"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", 
   RowBox[{
   "lGamma_", ",", " ", "ma_", ",", " ", "Deltat_", ",", " ", "h_", ",", 
    "lat_", ",", " ", "long_", ",", "xi_", ",", "va_", ",", " ", "chi_", ",", 
    " ", "gamma_", ",", " ", "d1_", ",", " ", "d2_", ",", "d3_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"q1", " ", ",", "q2", ",", " ", "q3"}], "}"}], "}"}], ".", " ", 
    
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdot", "[", 
         RowBox[{
         "lGamma", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", 
          " ", "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", 
          "d3"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sigmadot", "[", 
         RowBox[{
         "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", ",", 
          " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}], 
        "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DhDt", "[", 
         RowBox[{
         "h", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", 
          "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", 
          "d3"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "}"}]}], " ", "+", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"q4", ",", " ", "q5", ",", " ", "q6"}], "}"}], "}"}], ".", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "/", "ma"}], ",", " ", "0", ",", " ", "0"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", 
        RowBox[{"1", "/", 
         RowBox[{"(", 
          RowBox[{"ma", "*", "va", " ", "*", " ", 
           RowBox[{"Cos", "[", "gamma", "]"}]}], ")"}]}], ",", " ", "0"}], 
       "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"0", ",", " ", "0", ",", " ", 
        RowBox[{
         RowBox[{"-", "1"}], "/", 
         RowBox[{"(", 
          RowBox[{"ma", "*", "va"}], ")"}]}]}], "}"}]}], "}"}], ".", 
    RowBox[{"MAbarO", "[", 
     RowBox[{"chi", ",", " ", "gamma"}], "]"}], " ", ".", " ", 
    RowBox[{"Ft", "[", 
     RowBox[{
     "Deltat", ",", " ", "h", ",", "lat", ",", " ", "long", ",", "xi", ",", 
      "va", ",", " ", "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", 
      "d2", ",", "d3"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.847144236603455*^9, 3.847144265965396*^9}, {
  3.847144303293312*^9, 3.847144398063743*^9}, {3.847144461897786*^9, 
  3.8471444759631367`*^9}, {3.847144665220957*^9, 3.847144757145453*^9}, {
  3.847145526911852*^9, 3.847145544271574*^9}, {3.847145643065839*^9, 
  3.847145679970407*^9}, {3.847147186340395*^9, 3.847147200798661*^9}, {
  3.84714765873032*^9, 
  3.847147663722456*^9}},ExpressionUUID->"01544755-0503-41ce-b282-\
91bfd2264919"],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.84714476667889*^9, 3.8471447973838778`*^9}, {
   3.847145297920846*^9, 3.847145302747677*^9}, {3.8471453715101023`*^9, 
   3.8471453810466537`*^9}, 3.847145440024575*^9, {3.847145507240267*^9, 
   3.847145535828971*^9}, 3.847145579840968*^9, 3.847145631447384*^9, {
   3.84714582415357*^9, 3.8471458508110323`*^9}, {3.8471459283457747`*^9, 
   3.8471459905534*^9}, 3.847146603414905*^9, 3.8471466489580307`*^9, {
   3.847146862294856*^9, 3.847146880629027*^9}, {3.8471469227252083`*^9, 
   3.84714693007685*^9}, 3.8471470349089947`*^9, {3.847147186348838*^9, 
   3.84714720079982*^9}, {3.847147364969142*^9, 3.8471473655945*^9}, 
   3.847149954789249*^9},ExpressionUUID->"9d2a382e-04df-436b-bd38-\
ca4d6f295c28"],

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"q1", " ", ",", "q2", ",", " ", "q3"}], "}"}], "}"}], ".", " ", 
    
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sdot", "[", 
         RowBox[{
         "lGamma", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", 
          " ", "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", 
          "d3"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"sigmadot", "[", 
         RowBox[{
         "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", "chi", ",", 
          " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], "]"}], 
        "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DhDt", "[", 
         RowBox[{
         "h", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", 
          "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", 
          "d3"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}]}], "}"}]}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"sdot", "[", 
   RowBox[{
   "lGamma", ",", "lat", ",", " ", "long", ",", "xi", ",", "va", ",", " ", 
    "chi", ",", " ", "gamma", ",", " ", "d1", ",", " ", "d2", ",", "d3"}], 
   "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.84714476667889*^9, 3.8471447973838778`*^9}, {
   3.847145297920846*^9, 3.847145302747677*^9}, {3.8471453715101023`*^9, 
   3.8471453810466537`*^9}, 3.847145440024575*^9, {3.847145507240267*^9, 
   3.847145535828971*^9}, 3.847145579840968*^9, 3.847145631447384*^9, {
   3.84714582415357*^9, 3.8471458508110323`*^9}, {3.8471459283457747`*^9, 
   3.8471459905534*^9}, 3.847146603414905*^9, 3.8471466489580307`*^9, {
   3.847146862294856*^9, 3.847146880629027*^9}, {3.8471469227252083`*^9, 
   3.84714693007685*^9}, 3.8471470349089947`*^9, {3.847147108238792*^9, 
   3.847147200800817*^9}, 3.847147298021694*^9, {3.847147330216074*^9, 
   3.8471474047246943`*^9}, {3.847147460506946*^9, 3.84714752185642*^9}, {
   3.847147670748081*^9, 3.8471476819764233`*^9}, {3.847147714351633*^9, 
   3.847147719973037*^9}},
 CellLabel->
  "In[107]:=",ExpressionUUID->"c74283d5-5734-435c-956c-e7d33aa02d45"]
},
WindowSize->{1436, 763},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a5903c8a-be52-4c6d-9e51-fdb161cf3c85"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 201, 3, 81, "Text",ExpressionUUID->"e0592258-164f-4233-8d2c-bb4f2c79f025"],
Cell[762, 25, 253, 4, 45, "Text",ExpressionUUID->"35351875-222b-4d16-89f0-9d73a4269879",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[1018, 31, 586, 14, 52, "Input",ExpressionUUID->"208c51dc-1185-49f9-b8ba-5a5f84aac10e"],
Cell[1607, 47, 873, 18, 52, "Input",ExpressionUUID->"0514c19f-cd19-410f-863c-68b8b8be4f2e"],
Cell[2483, 67, 577, 14, 52, "Input",ExpressionUUID->"b695458a-7fc3-4846-b01d-3e544e1bd271"],
Cell[3063, 83, 4702, 135, 178, "Input",ExpressionUUID->"bbaf0df0-ee85-4940-9dc7-7fe91776b3e8",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7768, 220, 1059, 33, 34, "Output",ExpressionUUID->"05b2ded2-caa3-45ae-990b-8f6517cf85a6"],
Cell[8830, 255, 564, 17, 34, "Output",ExpressionUUID->"c1a3c72d-dc75-4d50-aebc-0df30c2e6bb4"],
Cell[9397, 274, 659, 20, 34, "Output",ExpressionUUID->"9c4bbb26-9d2f-41fd-8481-2fc337e535a8"],
Cell[10059, 296, 973, 29, 34, "Output",ExpressionUUID->"3aa925f2-b223-424f-97f2-0e12fb6dd567"],
Cell[11035, 327, 1118, 32, 34, "Output",ExpressionUUID->"88fd83d8-91a0-4a64-bad9-b34ffb4b239f"],
Cell[12156, 361, 545, 16, 34, "Output",ExpressionUUID->"6b9403de-a68b-488f-ad39-dfd11f82325b"],
Cell[12704, 379, 1003, 30, 34, "Output",ExpressionUUID->"288642df-0784-43e9-80f7-ad2bec45f3c4"],
Cell[13710, 411, 331, 10, 6, "Text",ExpressionUUID->"33155a2b-2511-488a-a503-60913a9f9575"],
Cell[CellGroupData[{
Cell[14066, 425, 5576, 116, 161, "Input",ExpressionUUID->"bc65398b-1e95-4d88-b4e4-ad2a8becb87a"],
Cell[19645, 543, 16175, 407, 398, "Output",ExpressionUUID->"ac673259-b1c1-41d2-bbd8-09785745f7b2"],
Cell[35823, 952, 47100, 1128, 875, "Output",ExpressionUUID->"f479887b-3cdb-43d8-a3da-e854693674ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82960, 2085, 804, 23, 73, "Input",ExpressionUUID->"5a27028c-e3b0-467f-8ec6-5c191eca6d36"],
Cell[83767, 2110, 12124, 288, 267, "Output",ExpressionUUID->"8dcf8c60-1d48-473c-a72f-b504067403ee"],
Cell[95894, 2400, 17810, 427, 372, "Output",ExpressionUUID->"a518a8eb-cfde-45c7-a747-171773242656"],
Cell[113707, 2829, 16841, 415, 350, "Output",ExpressionUUID->"5fbc2163-c1c0-4dd4-a333-334f3437808c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130585, 3249, 3517, 68, 94, "Input",ExpressionUUID->"2d7677be-703e-468b-a27d-192c34e7f33e"],
Cell[134105, 3319, 576, 16, 34, "Output",ExpressionUUID->"a364ca56-278b-4484-befc-a7e3f25391fc"],
Cell[134684, 3337, 708, 19, 51, "Output",ExpressionUUID->"1c3b0ab8-c000-4db1-b68c-247d6fd22dd5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135429, 3361, 5887, 131, 178, "Input",ExpressionUUID->"ac40dc70-341d-4bae-be2c-825a3e27a009"],
Cell[141319, 3494, 603, 17, 34, "Output",ExpressionUUID->"00839ee9-670c-4956-9fc1-61aa0cadd854"],
Cell[141925, 3513, 735, 20, 51, "Output",ExpressionUUID->"4b1b3054-effa-47a3-ab2f-81ba99e9ff4c"],
Cell[142663, 3535, 3618, 56, 63, "Message",ExpressionUUID->"9a72dcb8-cff0-4b27-a470-ecdfd13ce61d"],
Cell[146284, 3593, 139866, 3195, 2577, "Output",ExpressionUUID->"4d87aa81-92ef-4361-82af-b6d42fefefd3"],
Cell[286153, 6790, 228, 5, 34, "Output",ExpressionUUID->"fc7597cd-0b44-4b8f-a34a-1f43848f5e1f"],
Cell[286384, 6797, 3618, 56, 63, "Message",ExpressionUUID->"84def204-ebb9-40e2-a55f-a9195b5c7308"],
Cell[290005, 6855, 140001, 3198, 2631, "Output",ExpressionUUID->"2d8b3ff5-7017-403f-a63c-fc97e9b6694d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[430043, 10058, 2103, 57, 94, "Input",ExpressionUUID->"082d0dc1-0f56-46cd-a781-f45ba7679816"],
Cell[432149, 10117, 2887, 45, 63, "Message",ExpressionUUID->"40719363-1ace-42e3-925f-2c98ad7138b9"],
Cell[435039, 10164, 2280, 64, 56, "Output",ExpressionUUID->"87addd6b-048f-43e3-888a-e352ac312195"],
Cell[437322, 10230, 249, 6, 34, "Output",ExpressionUUID->"03cff654-ce77-407b-b21e-6f1a241a4996"],
Cell[437574, 10238, 249, 6, 34, "Output",ExpressionUUID->"c13c3887-3a84-4c12-84a8-355f896600ae"],
Cell[437826, 10246, 207, 4, 34, "Output",ExpressionUUID->"2c3c9154-6a07-4451-9e38-9b2d41a93198"]
}, Open  ]],
Cell[438048, 10253, 518, 11, 30, "Input",ExpressionUUID->"9c00d0bc-c7b2-47a8-a971-a6e00f0d3c12"],
Cell[438569, 10266, 982, 21, 30, "Input",ExpressionUUID->"e27a2517-93f6-44e0-ac0f-4cac1e4a7716"],
Cell[439554, 10289, 205, 4, 30, "Input",ExpressionUUID->"4de9a154-a39a-4a0d-b558-137a62b9e279"],
Cell[439762, 10295, 1407, 33, 52, "Input",ExpressionUUID->"8c8f9ede-0b32-4638-94ee-00b2013f3ec0"],
Cell[CellGroupData[{
Cell[441194, 10332, 2243, 55, 115, "Input",ExpressionUUID->"97e17675-e833-4ecd-92e0-19313e44b661"],
Cell[443440, 10389, 200, 5, 34, "Output",ExpressionUUID->"b40d0d98-89a0-42d1-8c3f-76bff4fae2ea"]
}, Open  ]],
Cell[443655, 10397, 2991, 76, 94, "Input",ExpressionUUID->"01544755-0503-41ce-b282-91bfd2264919"],
Cell[446649, 10475, 780, 11, 52, "Input",ExpressionUUID->"9d2a382e-04df-436b-bd38-ca4d6f295c28"],
Cell[447432, 10488, 2404, 54, 94, "Input",ExpressionUUID->"c74283d5-5734-435c-956c-e7d33aa02d45"]
}
]
*)

